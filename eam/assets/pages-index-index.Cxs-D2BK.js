import { r as e, o as a, c as s, w as t, i as o, a as r, b as n, d as l, u as i, t as d, e as c } from "./index-wWlO_IEm.js"; import { v as u } from "./index.BQvkGUtl.js"; import { _ as v } from "./boxue.js"; const p = v({ __name: "index", setup(v) { let p, _, g = [], m = e(30), f = e(!1), b = e(""); const h = async () => { try { const e = await navigator.mediaDevices.getUserMedia({ audio: !0 }); p = new MediaRecorder(e), p.ondataavailable = e => { g.push(e.data) }, p.onstop = () => { const e = new Blob(g, { type: "audio/wav" }); x(e), g = [] }, p.start(), f.value = !0, m.value = 30, b.value = `剩余时间: ${m.value}秒`, _ = setInterval((() => { m.value--, b.value = `剩余时间: ${m.value}秒`, m.value <= 0 && (clearInterval(_), w()) }), 1e3) } catch (e) { console.error("录音失败:", e.message), u({ luyin_error: e.message }) } }, w = () => { p && "recording" === p.state && (p.stop(), clearInterval(_), b.value = "录音已停止", f.value = !1) }, x = e => { const a = new FormData; a.append("file", e, "recording.wav"), fetch("http://192.168.100.101:10001/record", { method: "POST", body: a }).then((e => e.json())).then((e => { console.log("上传成功:", e), u({ luyin_success: "上传成功" }) })).catch((e => { console.error("上传失败:", e), u({ luyin_error: "上传失败" }) })) }; return a((() => { var e; console.log("21312"); const a = (null == (e = navigator.mediaDevices) ? void 0 : e.getUserMedia) || navigator.webkitGetUserMedia; u(a ? { quanxian_success: "能获取到录音权限" } : { quanxian_success: "getUserMedia is not supported in this browser" }) })), (e, a) => { const u = c, v = o; return r(), s(v, null, { default: t((() => [n(u, { onClick: h, disabled: i(f) }, { default: t((() => [l("开始录音")])), _: 1 }, 8, ["disabled"]), n(u, { onClick: w, disabled: !i(f) }, { default: t((() => [l("停止录音")])), _: 1 }, 8, ["disabled"]), n(v, { style: { "margin-top": "10px", "font-size": "18px" } }, { default: t((() => [l(d(i(b)), 1)])), _: 1 })])), _: 1 }) } } }, [["__scopeId", "data-v-4d997fca"]]); export { p as default };
